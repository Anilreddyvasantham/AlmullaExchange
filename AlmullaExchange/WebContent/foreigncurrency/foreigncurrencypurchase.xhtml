<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="../css/dataTable.css" />
	<script src="../js/SigWeb.js" type="text/javascript"></script>
	<script src="../js/digitalsignature.js"></script>
	<script type="text/javascript">
		//var baseUri = "http://localhost:47289/SigWeb/";
		var baseUri = makeUri();
		/* document.onkeydown = function(e) {

			//Enter button pressed 
			if (e.keyCode === 13) {
				return false;
			}
		}; */
		history.pushState(null, null, 'foreigncurrencypurchase.xhtml');
	    window.addEventListener('popstate', function(event) {
	    history.pushState(null, null, 'foreigncurrencypurchase.xhtml');
	    });
	</script>
	<script type="text/javascript">
		$(document).on("keypress", ".dropdown", function(event) {
			if (event.keyCode == 32) {
				$('.ui-selectonemenu-trigger', this).click();
			}
		});
	</script>

</h:head>

<h:body
	onload="#{foreignCurrencyPurchaseBean.documentSerialId}==0?proceErr.show();:proceErr.hide();">

	<f:view>
		<ui:include src="#{facesBean.header}"></ui:include>
		<ui:include src="#{facesBean.menu}"></ui:include>
		<f:event listener="#{foreignCurrencyPurchaseBean.populateSearchValue}"
			type="preRenderView" />

		<h:form id="form1" target="_blank">

			<p:confirmDialog id="proceErr" widgetVar="proceErr" width="400"
				resizable="false"
				visible="#{foreignCurrencyPurchaseBean.booProcedureDialog}"
				style="background-color: white !important;"
				header="#{msg['lbl.warningDailog']}" styleClass="warning"
				showEffect="clip" hideEffect="clip" closeOnEscape="true"
				closable="true" message="#{foreignCurrencyPurchaseBean.errMsg}">
			</p:confirmDialog>
			<p:confirmDialog id="succ1" widgetVar="succ1" width="400" height="17"
				resizable="false" style="background-color: white !important;"
				header="Warning Dailog" styleClass="warning" showEffect="clip"
				hideEffect="clip" closeOnEscape="true" closable="true"
				message="TRANSACTION LIMIT IS #{foreignCurrencyPurchaseBean.limitationAmount}">
			</p:confirmDialog>

			<p:dialog id="limitValidation" widgetVar="limitValidation"
				width="400" height="80" resizable="false"
				style="background-color: white !important;" styleClass="warning"
				header="Warning Dailog" closable="false" showEffect="clip"
				hideEffect="clip">
				<p:outputLabel
					value="Transaction limit exceed #{foreignCurrencyPurchaseBean.neededPurchaseAmount}"
					style="text-align: center; font-size:15px !important;" />
				<br />
				<p:outputLabel value="#{msg['lbl.doyouwanttosave']}"
					style="text-align: center; font-size:15px !important;" />
				<br />
				<p:commandButton value="#{msg['lbl.yes']}"
					actionListener="#{foreignCurrencyPurchaseBean.limitYes}"
					process="@this" oncomplete="limitValidation.hide()"
					style="margin-left: 150px !important;" />

				<p:commandButton value="#{msg['lbl.no']}"
					actionListener="#{foreignCurrencyPurchaseBean.limitNo}"
					process="@this" oncomplete="limitValidation.hide()" />
			</p:dialog>

			<p:dialog id="idNotF" widgetVar="idNotF" width="300" height="80"
				resizable="false" style="background-color: white !important;"
				styleClass="warning" header="Warning Dailog" closable="false"
				showEffect="clip" hideEffect="clip">
				<p:outputLabel value="#{msg['lbl.iDNotFound']}"
					style="text-align: center; font-size:15px !important;" />
				<br />
				<p:commandButton value="#{msg['lbl.ok']}"
					actionListener="#{foreignCurrencyPurchaseBean.idNotFound}"
					process="@this" style="margin-left: 150px !important;" />
			</p:dialog>

			<p:dialog id="complete" widgetVar="complete" width="400" height="80"
				resizable="false" style="background-color: white !important;"
				styleClass="success" header="Success" closable="false"
				showEffect="clip" hideEffect="clip" closeOnEscape="true">
				<p:outputLabel value="#{msg['lbl.printoption']}"
					style="text-align: center; font-size:15px !important;" />
				<br />
				<p:commandButton value="#{msg['lbl.print']}"
					actionListener="#{foreignCurrencyPurchaseBean.reportexecute}"
					onclick="PF('complete').hide()"
					style="margin-left: 150px !important;">
					<p:ajax event="click" update=":form1:mainPanel" />
				</p:commandButton>
			</p:dialog>

			<p:dialog id="denaminationComplete" widgetVar="denaminationComplete"
				width="300" height="80" resizable="false"
				style="background-color: white !important;" styleClass="warning"
				header="Warning Dailog" closable="false" showEffect="clip"
				hideEffect="clip">
				<p:outputLabel value="#{msg['lbl.denaminationValid']}"
					style="text-align: center; font-size:15px !important;" />
				<br />
				<p:commandButton value="#{msg['lbl.ok']}"
					actionListener="#{foreignCurrencyPurchaseBean.clickDenaminationOK}"
					process="@this" style="margin-left: 150px !important;" />
			</p:dialog>
			<p:confirmDialog id="showValid" widgetVar="showValid" width="600"
				height="17" resizable="false"
				style="background-color: white !important;" header="Warning Dailog"
				styleClass="warning" showEffect="clip" hideEffect="clip"
				closeOnEscape="true" closable="true"
				message="#{msg['lbl.totalamountcantsmallerthansaleamount']}  #{foreignCurrencyPurchaseBean.saleAmount}">
			</p:confirmDialog>

			<p:dialog id="success" widgetVar="success" width="400" height="80"
				resizable="false" style="background-color: white !important;"
				styleClass="success" header="Success" closable="false"
				showEffect="clip" hideEffect="clip">
				<p:outputLabel value="#{msg['lbl.dataissuccessfullysaved']}"
					style="text-align: center; font-size:15px !important;" />
				<br />
				<p:commandButton value="#{msg['lbl.ok']}"
					actionListener="#{foreignCurrencyPurchaseBean.clickOnOKSave}"
					process="@this" style="margin-left: 150px !important;" />
			</p:dialog>

			<p:confirmDialog id="idNotFound" widgetVar="idNotFound" width="400"
				height="17" resizable="false"
				style="background-color: white !important;" header="Warning Dailog"
				styleClass="warning" showEffect="clip" hideEffect="clip"
				closeOnEscape="true" closable="true"
				message="#{msg['lbl.iDNotFound']}">
			</p:confirmDialog>

			<p:confirmDialog id="dlgNegNotAllowed" widgetVar="dlgNegNotAllowed"
				width="700" height="17" resizable="false"
				style="background-color: white !important;" header="Warning Dailog"
				styleClass="warning" showEffect="clip" hideEffect="clip"
				closeOnEscape="true" closable="true"
				message="#{msg['lbl.noofnotescantbenegative']}">
			</p:confirmDialog>

			<p:confirmDialog id="dlgSaleCannotZero" widgetVar="dlgSaleCannotZero"
				resizable="false" style="background-color: white !important;"
				header="Warning Dailog" styleClass="warning" showEffect="clip"
				hideEffect="clip" closeOnEscape="true" closable="true"
				message="#{msg['lbl.totalsaleshouldbemorethanzero']}">
			</p:confirmDialog>

			<p:confirmDialog id="dlgRefundCashMessage"
				widgetVar="dlgRefundCashMessage" width="600" height="17"
				resizable="false" style="background-color: white !important;"
				header="Warning Dailog" styleClass="warning" showEffect="clip"
				hideEffect="clip" closeOnEscape="true" closable="true"
				message="#{msg['lbl.totallocalcashcantsmallerthantotalfundreceipt']}  #{foreignCurrencyPurchaseBean.totalRefundCashRecipt}">
			</p:confirmDialog>

			<p:confirmDialog id="dlgTotalRefundMessage"
				widgetVar="dlgTotalRefundMessage" width="600" height="17"
				resizable="false" style="background-color: white !important;"
				header="Warning Dailog" styleClass="warning" showEffect="clip"
				hideEffect="clip" closeOnEscape="true" closable="true"
				message="#{msg['lbl.totolamountthantotalrefundamount']}  ">
			</p:confirmDialog>

			<p:confirmDialog id="notapprove" widgetVar="notapproved" width="500"
				height="17" resizable="false"
				style="background-color: white !important;" header="Warning Dailog"
				styleClass="warning" showEffect="clip" hideEffect="clip"
				closeOnEscape="true" closable="true"
				message="Your Exceed Limit #{foreignCurrencyPurchaseBean.neededPurchaseAmount}">
			</p:confirmDialog>


			<table align="left" width="100%" style="height: 100%;">
				<tr>
					<td align="left" valign="top" style="height: 100%;"><ui:include
							src="#{facesBean.fxdeal_menu}"></ui:include></td>

					<td class="rightColumn" valign="top"><h:panelGroup
							layout="block" class="container">
							<h:panelGroup layout="block" class="main_div">
								<div class="menu_button">
									<img style="cursor: pointer; position: relative; left: 15px;"
										id="HideHandle" name="HideHandle"
										src="../images/toggle_plus.png" alt=""
										onclick='hideLeftCol("leftCol");closeMenus();' />
								</div>

								<p:dialog id="invalidNoOFNotes" widgetVar="invalidNoOFNotes"
									modal="true" width="350" height="100" resizable="false"
									style="background-color: white !important;"
									styleClass="warning" header="#{msg['lbl.warningDailog']}"
									closable="false" showEffect="clip" hideEffect="clip">
									<p:outputLabel
										value="#{msg['lbl.enternoofnoteswithincurrentstock']} : #{foreignCurrencyPurchaseBean.validNoOFQuantity} !!!!!" />
									<br />
									<h:panelGroup style="display:block; text-align:center">
										<p:commandButton value="#{msg['lbl.ok']}"
											actionListener="#{foreignCurrencyPurchaseBean.clearDataTableClearDenomination}"
											onclick="PF('invalidNoOFNotes').hide();" process="@this" />
									</h:panelGroup>
								</p:dialog>

								<h1>
									<h:outputText value="#{msg['lbl.foreignCurrencyPurchase']}" />
								</h1>
								<p:panel styleClass="shadow" id="mainPanel">

									<p:confirmDialog id="err" widgetVar="err" width="500"
										showHeader="false" resizable="false" header="Warning Message"
										visible="foreignCurrencyPurchaseBean.booVisble"
										styleClass="warning"
										style=" border:2px solid #F33535 !important; padding:0px !important;  color:red; 
														font-weight:bold; background:url('../images/warning-icon.png') 5px 15px no-repeat #FFF !important;"
										showEffect="explode" hideEffect="explode"
										message="#{foreignCurrencyPurchaseBean.errmsg}">
									</p:confirmDialog>

									<p:dialog modal="true" showHeader="false"
										widgetVar="pleaseWait" id="pleaseWait" width="300" height="60"
										resizable="false" draggable="false" closable="false"
										style=" border: 2px green solid !important;background-color: #FFF !important;">
										<div
											style="margin-left: 15px !important; font-size: 18px !important; color: #459D45 !important;">
											<p:graphicImage value="../images/processImg.gif"
												style="float: left !important; margin-right: 24px !important; " />
											<p:outputLabel value="Please wait ........"
												style="color: green !important; font-size: 20px !important; font-weight: bold; margin-top: 10px;" />
										</div>
									</p:dialog>

									<p:dialog id="customerregproceed"
										widgetVar="customerregproceed" showHeader="false"
										resizable="false"
										style=" border:2px solid #F33535 !important; padding:0px !important;  color:red !important; font-weight:bold; background:url('../images/warning-icon.png') 5px 15px no-repeat #FFF !important;"
										showEffect="clip" hideEffect="clip" closeOnEscape="true"
										closable="true" modal="true">

										<p:outputLabel
											value="This Customer Partially Registered Do You want to Continue Registration" />
										<br />

										<!-- <p:commandButton value="#{msg['lbl.yes']}"
											oncomplete="customerregproceed.hide()" process="@this"
											action="#{personalRemittanceBean.redirectToCustomerPage}" />
										<p:commandButton value="#{msg['lbl.no']}"
											oncomplete="customerregproceed.hide()" process="@this" /> -->
									</p:dialog>

									<p:dialog modal="true" showHeader="false" widgetVar="process"
										id="process" width="300" height="60" resizable="false"
										draggable="false" closable="false"
										style=" border: 2px green solid !important;background-color: #FFF !important;">
										<div
											style="margin-left: 15px !important; font-size: 18px !important; color: #459D45 !important;">
											<p:graphicImage value="../images/processImg.gif"
												style="float: left !important; margin-right: 24px !important; " />
											<p:outputLabel value="Please wait ........"
												style="color: green !important; font-size: 20px !important; font-weight: bold; margin-top: 10px;" />
										</div>
									</p:dialog>

									<p:confirmDialog id="csp" widgetVar="csp" width="500"
										showHeader="false" resizable="false" header="Warning Message"
										styleClass="warning"
										style=" border:2px solid #F33535 !important; padding:0px !important;  color:red; font-weight:bold; background:url('../images/warning-icon.png') 5px 15px no-repeat #FFF !important;"
										showEffect="explode" hideEffect="explode"
										message="#{foreignCurrencyPurchaseBean.errmsg}">
									</p:confirmDialog>

									<p:panel
										rendered="#{foreignCurrencyPurchaseBean.fcPurchageLabel}">
										<h2>
											<h:outputText value="#{msg['lbl.foreignCurrencyPurchase']}" />
										</h2>
									</p:panel>

									<p:panel
										rendered="#{foreignCurrencyPurchaseBean.localcashpaidtoCustomerLabel}">
										<h2>
											<h:outputText value="#{msg['lbl.localCashPaidToCustomer']}" />
										</h2>
									</p:panel>

									<p:panel styleClass="panel_border">

										<p:panel
											rendered="#{foreignCurrencyPurchaseBean.booRenderFirstPanel}">

											<p:panel styleClass="left_col">

												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.receiptNo']}"></h:outputText>
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:panelGrid style="width:100%;">
														<p:row>

															<p:column
																style="width:30%; text-align:left; padding:0px 5px 0px 0px !important;">
																<p:inputText id="financeYear"
																	value="#{foreignCurrencyPurchaseBean.finaceYear}" tabindex="-1"
																	required="true" requiredMessage="Enter Financial Year"
																	readonly="true">
																	<p:ajax event="blur" update="msgfinanceYear" />
																	<p:message for="financeYear" display="text"
																		id="msgfinanceYear" />
																</p:inputText>
															</p:column>

															<p:column
																style="width:70%; padding:0px 5px 0px 10px !important;">
																<p:inputText id="documentSerialId"
																	value="#{foreignCurrencyPurchaseBean.documentSerialId}" tabindex="-1"
																	required="true"
																	requiredMessage="Enter Document Serial ID"
																	readonly="true">
																	<p:ajax event="blur" update="msgdocumentSerialId" />
																	<p:message for="documentSerialId" display="text"
																		id="msgdocumentSerialId" />
																</p:inputText>
															</p:column>

														</p:row>
													</p:panelGrid>
												</p:panel>
											</p:panel>

											<p:panel styleClass="left_col">

												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.date']}"></h:outputText>
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:inputText id="currentDate" value="#{currentDate}" tabindex="-1"
														readonly="true" size="8" required="true"
														requiredMessage="Enter Current Date">
														<p:ajax event="blur" update="msgcurrentDate" />
														<p:message for="currentDate" display="text"
															id="msgcurrentDate" />
														<f:convertDateTime pattern="dd-MM-yyyy" type="date" />
													</p:inputText>
												</p:panel>

											</p:panel>

											<p:panel styleClass="left_col">

												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.location']}"></h:outputText>
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:inputText
														value="#{foreignCurrencyPurchaseBean.location}" tabindex="-1"
														style="font-size:11px !important;" readonly="true" />
												</p:panel>

											</p:panel>

											<p:panel styleClass="left_col">

												<p:panel styleClass="inner_left_col">
													<h:outputText
														value="#{msg['lbl.customerrefno']}/#{msg['lbl.idNumber']}" />
													<h:outputText value="*" style="color:red !important;" />
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:panelGrid id="pnlPopulateCustomerDetails"
														style="width:100%;">
														<p:row>
															<p:column
																style="width:30%; text-align:left; padding:0px 5px 0px 0px !important;">
																<p:inputText id="idRef"
																	value="#{foreignCurrencyPurchaseBean.idRef}" tabindex="-1"
																	readonly="true">
																	<p:tooltip for="name" value="#{msg['lbl.customerRef']}" />
																</p:inputText>
															</p:column>															
															<p:column
																style="width:60%; padding:0px 5px 0px 10px !important;">
																<p:message for="id" display="text" id="msgid" />
																<p:focus for="id" rendered="#{foreignCurrencyPurchaseBean.focus}"></p:focus>
																<p:inputText id="id"
																	value="#{foreignCurrencyPurchaseBean.id}" tabindex="0"
																	required="true" requiredMessage="Enter ID number"
																	readonly="#{foreignCurrencyPurchaseBean.forNextPanels}">
													
																	<p:ajax event="blur"
																		listener="#{foreignCurrencyPurchaseBean.idOnBlur}"
																		update="name, msgid, telephone,idRef,err,id" />
																	<p:tooltip for="id" value="#{msg['lbl.idnumber']}" />
																</p:inputText>
															</p:column>
															<p:column
																style="width:5%; text-align:right !important;  padding:3px 0px 0px 5px !important;">
																<p:commandButton id="searchButton" value=""
																	styleClass="search_icon"
																	disabled="#{foreignCurrencyPurchaseBean.forNextPanels}"
																	action="#{foreignCurrencyPurchaseBean.searchClicked}"
																	process="@this">
																	<p:tooltip for="searchButton"
																		value="#{msg['lbl.clickToSearch']}" />
																</p:commandButton>
															</p:column>

														</p:row>
													</p:panelGrid>
												</p:panel>
											</p:panel>

											<p:panel styleClass="left_col">
												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.customerName']}"></h:outputText>
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:inputText id="name"
														value="#{foreignCurrencyPurchaseBean.name}" tabindex="-1"
														readonly="true" style="font-size:14px !important;">
														<p:tooltip for="name" value="#{msg['lbl.customername']}" />
													</p:inputText>
												</p:panel>

											</p:panel>


											<p:panel styleClass="left_col">

												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.telephone']}"></h:outputText>
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:inputText id="telephone"
														value="#{foreignCurrencyPurchaseBean.mobile}" tabindex="-1"
														readonly="true" />
												</p:panel>

											</p:panel>

										</p:panel>

										<!-- Digital Signature Capture Here  -->
										<p:panel id="signaturePanel"
											rendered="#{foreignCurrencyPurchaseBean.signaturePanel}"
											styleClass="left_col"
											style="background-color:none !important; padding:0px !important;">
											<p:panel styleClass="inner_left_col">
												<h:outputText value="#{msg['lbl.signature']}"></h:outputText>
												<h:outputText value="*" style="color:red !important;" />
											</p:panel>
											<p:panel styleClass="inner_right_col">

												<table width="100%" height="20%" border="0" color="#CCC">
													<tr>
														<td style="border: 1px solid #CCC;"><canvas id="cnv"
																width="280" height="100"></canvas></td>
													</tr>
												</table>
												<p:commandButton id="s1" value="#{msg['lbl.remitsign']}"
													onclick="javascript:onSign()" onstart="process.show();"
													onsuccess="process.hide();" />
												<h:inputHidden id="digitalsign"
													value="#{foreignCurrencyPurchaseBean.digitalSignature}">
												</h:inputHidden>

											</p:panel>
										</p:panel>

										<p:panel id="signatureSpecimenPanel"
											rendered="#{foreignCurrencyPurchaseBean.signaturePanel}"
											styleClass="left_col"
											style="background-color:none !important; padding:0px !important;">
											<p:panel styleClass="inner_left_col">
												<h:outputText
													value="&nbsp;&nbsp;#{msg['lbl.signaturespecimen']}"></h:outputText>
											</p:panel>
											<p:panel styleClass="inner_right_col">
												<h:graphicImage
													url="data:image/gif;base64,#{foreignCurrencyPurchaseBean.signatureSpecimen}"
													style=" width:100%; height:100px;" />

											</p:panel>
										</p:panel>

										<p:panel id="purchasePanel"
											rendered="#{foreignCurrencyPurchaseBean.booPurchasePanel}"
											style="background-color:none !important; padding:0px !important;">
											<p:panel styleClass="left_col">

												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.purchaseCurrency']}" />
													<h:outputText value="*" style="color:red !important;" />
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:message for="purchasecurrency" display="text"
														id="msgpurchasecurrency" />
													<p:selectOneMenu id="purchasecurrency"
														styleClass="dropdown"
														value="#{foreignCurrencyPurchaseBean.currencyId}"
														filter="true" filterMatchMode="contains" required="true"
														requiredMessage="Choose Currency">
														<f:selectItem
															itemLabel="#{msg['lbl.selectpurchasecurrency']} "
															itemValue="" />
														<f:selectItems
															value="#{foreignCurrencyPurchaseBean.lstCurrencyList}"
															var="c" itemValue="#{c.currencyId}"
															itemLabel="#{c.currencyCode} - #{c.currencyName}" />
														<p:ajax event="change"
															update="pnlDataTable, pnlForeignCurrencyName, pnlgdtotpuramt,mainPanel"
															listener="#{foreignCurrencyPurchaseBean.getDenominationTable}"
															onstart="process.show();" onsuccess="process.hide();" />
													</p:selectOneMenu>
												</p:panel>
											</p:panel>

											<p:panel styleClass="left_col">
												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.saleCurrency']}"></h:outputText>
												</p:panel>

												<p:panel styleClass="inner_right_col">
													<p:inputText tabindex="-1"
														value="#{foreignCurrencyPurchaseBean.saleCurrencyCode}"
														readonly="true" />
												</p:panel>
											</p:panel>

											<div class="clearfix"></div>
											<p:panel styleClass="left_col">

												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.neededPurchaseAmount']}" />
													<h:outputText value="*" style="color:red !important;" />
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:inputText id="neededPurchaseAmount"
														value="#{foreignCurrencyPurchaseBean.neededPurchaseAmount}"
														readonly="false" required="true"
														requiredMessage="Please enter purchase amount">
														<p:ajax event="blur"
															listener="#{foreignCurrencyPurchaseBean.checkLimit}"
															update="notapprove,csp,neededPurchaseAmount"
															process="@this" />
														<p:message for="neededPurchaseAmount" display="text" />
													</p:inputText>
												</p:panel>
											</p:panel>


											<div class="clearfix"></div>
											<p:spacer height="30px;" />


											<p:panel id="pnlDataTable"
												style="border:none !important; padding-right:5px; padding-bottom:15px; margin:5px; background-color:none !important; ">

												<h:messages styleClass="errorMessage" globalOnly="true"
													style="text:color:red ;text-align:center !important;" />


												<table cellpadding="0" cellspacing="0" border="0"
													width="100%" class="mytable">
													<tr>
														<th>#{msg['lbl.fclocalpurchaseserialno']}</th>
														<th>#{msg['lbl.fclocalpurchasedenominationname']}</th>
														<th>#{msg['lbl.fclocalpurchasenoofnotes']}</th>
														<th>#{msg['lbl.purchaseAmount']}</th>
														<th>#{msg['lbl.exchangeRate']}</th>
														<th>#{msg['lbl.saleAmount']}</th>
													</tr>
													<ui:repeat
														value="#{foreignCurrencyPurchaseBean.denominationBeanList}"
														var="o" varStatus="status">

														<tr>
															<td style="width: 15% ! important;"><h:outputText
																	value="#{status.index+1}" /></td>
															<td style="width: 15% ! important;"><h:outputText
																	value="#{o.denominationDesc}" /></td>

															<td style="width: 15% ! important;"><p:inputText
																	id="noOfNotes" value="#{o.noOfNotes}"
																	style="text-align:center !important;">
																	<p:ajax event="change"
																		listener="#{foreignCurrencyPurchaseBean.onCellEdit(o)}"
																		update=":form1:pnlDataTable, :form1:avgRateColumn,:form1:err" />
																	<p:message for="noOfNotes" display="text" 
																		style="text-shadow:none !important;" />
																</p:inputText></td>

															<td style="width: 15% ! important;"><h:outputText
																	value="#{o.purchaseAmount}" /></td>

															<td style="width: 15% ! important;"><p:outputLabel
																	id="exchangeRate" value="#{o.exchangeRate}"
																	required="true"
																	requiredMessage="Please enter exchange Rate"
																	style="text-align:center !important;">
																	<p:ajax event="blur"
																		listener="#{foreignCurrencyPurchaseBean.onCellEditExchangeRate(o)}"
																		update=":form1:pnlDataTable,:form1:mainPanel" />
																	<p:message for="exchangeRate" display="text"
																		style="text-shadow:none !important;" />
																</p:outputLabel></td>

															<td style="width: 15% ! important;"><h:outputText
																	value="#{o.salesAmount}" id="price" /></td>
														</tr>
													</ui:repeat>


												</table>


												<p:spacer height="10px" />
												<p:panelGrid style="width:100%;" id="pnlgdtotpuramt">
													<p:row>
														<p:column style="width:46%; text-align:right;">
															<h:outputText style="font-weight:bold;"
																value="#{msg['lbl.totalPurchaseAmount']}"></h:outputText>
														</p:column>
														<p:column style="width:18%;">
															<p:inputText id="totalPurchaseAmount" tabindex="-1"
																value="#{foreignCurrencyPurchaseBean.totalPurchaseAmount}"
																readonly="true" />
														</p:column>

														<p:column style="width:18%; text-align:right;">
															<h:outputText style="font-weight:bold;"
																value="#{msg['lbl.totalSaleAmount']}"></h:outputText>
														</p:column>
														<p:column style="width:18%;">
															<p:inputText id="totalSellAmount" tabindex="-1"
																value="#{foreignCurrencyPurchaseBean.tempSaleAmount}"
																readonly="true" />
														</p:column>
													</p:row>

													<h:panelGroup layout="block" class="clearfix" />

													<p:row>
														<p:column style="width:46%; text-align:right;" />
														<p:column style="width:18%;" />
														<p:column style="width:18%; text-align:right;">
															<h:outputText style="font-weight:bold;"
																value="#{msg['lbl.totalSaleAmount']} (Rounded)"></h:outputText>
														</p:column>
														<p:column style="width:18%;">
															<p:inputText id="roundtotalSellAmount" tabindex="-1"
																value="#{foreignCurrencyPurchaseBean.saleAmount}"
																readonly="true" />
														</p:column>
													</p:row>
												</p:panelGrid>
											</p:panel>

											<h2>
												<h:outputText value="#{msg['lbl.foreignCurrencyPurchase']}"></h:outputText>
											</h2>

											<p:panel styleClass="left_col">
												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.pymtmode']}" />
													<h:outputText value="*" style="color:red !important;" />
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:message for="paymentmode" display="text"
														id="msgpaymentmode" />
													<p:selectOneMenu id="paymentmode" styleClass="dropdown"
														value="#{foreignCurrencyPurchaseBean.colpaymentmodeId}"
														filterMatchMode="contains" required="true" filter="true"
														requiredMessage="please Select Payment Mode ">
														<f:selectItem itemLabel="#{msg['lbl.selectmodetyp']}" />
														<f:selectItems
															value="#{foreignCurrencyPurchaseBean.lstFetchAllPayMode}"
															var="c"
															itemLabel="#{c.paymentMode.paymentCode} - #{c.localPaymentName}"
															itemValue="#{c.paymentMode.paymentModeId}" />
														<p:ajax event="change"
															listener="#{foreignCurrencyPurchaseBean.changeofPaymentMode}"
															update="msgpaymentmode,booBanks,chequeRef,booChequeDate,booApprovalNumber,err"
															onstart="process.show();" onsuccess="process.hide();" />
													</p:selectOneMenu>
												</p:panel>
											</p:panel>

											<p:panel styleClass="left_col" id="pnlForeignCurrencyName">
												<p:panelGrid style="width:100%;">
													<p:row>
														<p:column style="width:30%;">
															<h:outputText value="#{msg['lbl.exchangeRate']}"></h:outputText>
															<h:outputText value="*" style="color:red !important;" />
														</p:column>
														<p:column style="width:20%; padding-left:15px !important;">
															<p:inputText id="foreignCurrencyName" tabindex="-1"
																value="#{foreignCurrencyPurchaseBean.foreignCurrencyName}"
																readonly="true" />
														</p:column>
														<p:column style="width:5%;">
															<h:outputText value="@"></h:outputText>
														</p:column>
														<p:column
															style="width:50%; padding-top:5px !important; padding-right:18px !important;">
															<p:panel id="avgRateColumn"
																style="padding:0px !important; margin:0px !important;">
																<p:inputText id="avgExchageRate" tabindex="-1"
																	value="#{foreignCurrencyPurchaseBean.avgExchageRate}"
																	readonly="true" />
															</p:panel>
														</p:column>
													</p:row>
												</p:panelGrid>
											</p:panel>

											<div class="clearfix"></div>

											<p:panel styleClass="left_col" id="booBanks">
												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.banks']}" />
													<h:outputText value="*" style="color:red !important;"
														rendered="#{!foreignCurrencyPurchaseBean.booRenderColBanks}" />
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:message id="msgcolbankid" for="colbankid" display="text" />
													<p:selectOneMenu id="colbankid" styleClass="dropdown"
														value="#{foreignCurrencyPurchaseBean.colBankCode}"
														filterMatchMode="contains" filter="true"
														required="#{!foreignCurrencyPurchaseBean.booRenderColBanks}"
														requiredMessage="Please Select Bank"
														disabled="#{foreignCurrencyPurchaseBean.booRenderColBanks}">
														<f:selectItem itemLabel="#{msg['lbl.selectBank']}"
															itemValue="" />
														<f:selectItems
															value="#{foreignCurrencyPurchaseBean.bankMasterList}"
															var="c"
															itemLabel="#{c.bankShortName} - #{c.bankFullName}"
															itemValue="#{c.chequeBankCode}" />
														<p:ajax update="msgcolbankid" event="change"
															listener="#{foreignCurrencyPurchaseBean.getLocalBankListforIndicator}"
															onstart="process.show();" onsuccess="process.hide();" />
													</p:selectOneMenu>
												</p:panel>
											</p:panel>

											<p:panel styleClass="left_col">
												<p:panelGrid style="width:100%;">
													<p:row>
														<p:column style="width:30%;">
															<h:outputText value="#{msg['lbl.remarks']}"></h:outputText>
														</p:column>

														<p:column style="width:70%;">
															<p:inputText id="remksId"
																value="#{foreignCurrencyPurchaseBean.remarks}" />
														</p:column>
													</p:row>
												</p:panelGrid>
											</p:panel>

											<div class="clearfix"></div>

											<p:panel styleClass="left_col" id="chequeRef">
												<p:panel styleClass="inner_left_col">
													<h:outputText value="Cheque Reference" />
													<h:outputText value="*" style="color:red !important;"
														rendered="#{!foreignCurrencyPurchaseBean.booRenderColCheque}" />
												</p:panel>
												<p:panel styleClass="inner_right_col">
													<p:message for="colChequeRefId" display="text"
														id="msgcolChequeRefId" />
													<p:inputText id="colChequeRefId"
														value="#{foreignCurrencyPurchaseBean.colChequeRef}"
														required="#{!foreignCurrencyPurchaseBean.booRenderColCheque}"
														requiredMessage="Please Enter Cheque Ref Number"
														disabled="#{foreignCurrencyPurchaseBean.booRenderColCheque}">
														<p:ajax update="msgcolChequeRefId" />
													</p:inputText>
												</p:panel>
											</p:panel>

											<p:panel styleClass="left_col">
												<p:panelGrid style="width:100%;">
													<p:row>
														<p:column style="width:30%;">
															<h:outputText value="#{msg['lbl.sourceOfFund']}"></h:outputText>
															<h:outputText value="*" style="color:red !important;" />
														</p:column>

														<p:column style="width:70%;">
															<p:message for="sourceofincome" id="sourceid"
																display="text" />
															<p:selectOneMenu id="sourceofincome"
																styleClass="dropdown"
																value="#{foreignCurrencyPurchaseBean.sourceOfIncomes}"
																required="true"
																requiredMessage="Choose Source of Income" filter="true"
																filterMatchMode="contains">
																<f:selectItem
																	itemLabel="#{msg['lbl.selectsourceoffunds']}"
																	itemValue="" />
																<f:selectItems
																	value="#{foreignCurrencyPurchaseBean.lstSourceOfIncome}"
																	var="s"
																	itemLabel="#{s.sourceOfIncomeId.sourceCode} - #{s.sourceOfIncomeFullDesc}"
																	itemValue="#{s.sourceOfIncomeId.sourceId}" />
																<p:ajax event="change" update="sourceid" />
															</p:selectOneMenu>

														</p:column>
													</p:row>
												</p:panelGrid>
											</p:panel>

											<div class="clearfix"></div>

											<p:panel styleClass="left_col" id="booChequeDate">
												<p:panel styleClass="inner_left_col">
													<h:outputText value="Cheque Date" />
													<h:outputText value="*" style="color:red !important;"
														rendered="#{!foreignCurrencyPurchaseBean.booRenderColCheque}" />
												</p:panel>
												<p:panel styleClass="inner_right_col">

													<p:message for="hdValueDate" display="text" id="hdValDate" />
													<p:calendar id="hdValueDate"
														value="#{foreignCurrencyPurchaseBean.colChequeDate}"
														mode="popup" pattern="dd/MM/yyyy"
														mindate="#{foreignCurrencyPurchaseBean.effectiveMinDate}"
														navigator="true" readonlyInput="true"
														required="#{!foreignCurrencyPurchaseBean.booRenderColCheque}"
														requiredMessage="Enter Cheque Date"
														disabled="#{foreignCurrencyPurchaseBean.booRenderColCheque}">
														<p:ajax update="hdValDate" />
													</p:calendar>
												</p:panel>
											</p:panel>

											<p:panel styleClass="left_col">
												<p:panelGrid style="width:100%;">
													<p:row>
														<p:column style="width:30%;">
															<h:outputText value="#{msg['lbl.purpose']}"></h:outputText>
															<h:outputText value="*" style="color:red !important;" />
														</p:column>
														<p:column style="width:70%;">
															<p:message for="purposeoftransaction"
																id="purposeoftransactionid" display="text" />
															<p:selectOneMenu id="purposeoftransaction"
																styleClass="dropdown"
																value="#{foreignCurrencyPurchaseBean.purposeOfTransactions}"
																required="true"
																requiredMessage="Choose Purpose of Transaction"
																filter="true" filterMatchMode="contains">
																<f:selectItem itemLabel="#{msg['lbl.selectpurpose']} "
																	itemValue="" />
																<f:selectItems
																	value="#{foreignCurrencyPurchaseBean.lstPurposeOfTransaction}"
																	var="p" itemValue="#{p.purposeId}"
																	itemLabel="#{p.purposeFullDesc}"></f:selectItems>
																<p:ajax event="change" update="purposeoftransactionid" />
															</p:selectOneMenu>

														</p:column>
													</p:row>
												</p:panelGrid>
											</p:panel>

											<div class="clearfix"></div>

											<p:panel styleClass="left_col" id="booApprovalNumber">
												<p:panel styleClass="inner_left_col">
													<h:outputText value="#{msg['lbl.approvalNumber']}" />
													<h:outputText value="*" style="color:red !important;"
														rendered="#{!foreignCurrencyPurchaseBean.booRenderColApprovalNo}" />
												</p:panel>

												<p:panel styleClass="inner_right_col" id="colChequeAppNoId">
													<p:message id="msgcolChequeAppNo" for="colChequeAppNo"
														display="text" />
													<p:inputText id="colChequeAppNo"
														value="#{foreignCurrencyPurchaseBean.colApprovalNo}"
														styleClass="dropdown"
														required="#{!foreignCurrencyPurchaseBean.booRenderColApprovalNo}"
														requiredMessage="Please Enter Approval No"
														disabled="#{foreignCurrencyPurchaseBean.booRenderColApprovalNo}">
														<p:ajax update="msgcolChequeAppNo" />
													</p:inputText>
												</p:panel>
											</p:panel>

											<div class="clearfix"></div>

											<h:panelGroup layout="block" styleClass="shadow_button">
												<p:commandButton value="#{msg['lbl.accept']}"
													styleClass="dropdown"
													onmouseover="javascript:onClear()"
													onclick="process.show();" oncomplete="process.hide()"
													action="#{foreignCurrencyPurchaseBean.acceptFromPurchase}"
													update="mainPanel,err" style="margin-right:10px;" />
												<p:commandButton value="#{msg['lbl.exit']}"
													styleClass="dropdown"
													action="#{bankBranchDetails.cancel}" update="mainPanel"
													onstart="process.show();" onsuccess="process.hide();"
													immediate="true" />
											</h:panelGroup>
											<h:panelGroup layout="block" class="clearfix" />
										</p:panel>

										<!--END OF FIRST PANEL  -->

										<div class="clearfix"></div>
										<p:panel id="panelDatatable"
											rendered="#{foreignCurrencyPurchaseBean.booPanelDatatable}"
											style="background-color:none !important; padding:0px !important;">

											<p:panel id="secondpanelDenoDatatable"
												rendered="#{foreignCurrencyPurchaseBean.booSecondPanelDenoDatatable}">

												<table cellpadding="0" cellspacing="0" border="0"
													width="100%" class="mytable">
													<tr>
														<th>#{msg['lbl.fclocalpurchaseserialno']}</th>
														<th>#{msg['lbl.fclocalpurchasedenominationname']}</th>
														<th>#{msg['lbl.fclocalpurchasecurrentstock']}</th>
														<th>#{msg['lbl.fclocalpurchasenoofnotes']}</th>
														<th>#{msg['lbl.fclocalpurchasecashamount']}</th>

													</tr>
													<ui:repeat value="#{foreignCurrencyPurchaseBean.lstData}"
														var="f" id="uirepeat">

														<tr>
															<td style="width: 15% ! important;"><h:outputText
																	value="#{f.serial}." /></td>
															<td style="width: 15% ! important;"><h:outputText
																	value="#{f.denominationDesc}" /></td>

															<td style="width: 15% ! important;"><h:outputText
																	value="#{f.stock}" /></td>
															<td style="width: 15% ! important;"><p:message
																	for="q" display="text"
																	style="text-shadow:none !important;" /> <p:inputText
																	id="q" value="#{f.qty}"
																	style="text-align:center !important;">
																	<p:ajax event="change"
																		listener="#{foreignCurrencyPurchaseBean.oncellEditForeign(f)}"
																		update=":form1:total, :form1:invalidNoOFNotes, :form1:showValid,price,:form1:buttonsavenext"
																		process="@this" onstart="process.show();"
																		onsuccess="process.hide();" />
																	<p:message for="q" display="text"
																		style="text-shadow:none !important;" />
																</p:inputText></td>
															<td style="width: 15% ! important;"><h:outputText
																	value="#{f.price}" id="price" /></td>
														</tr>
													</ui:repeat>
												</table>

												<div class="clearfix"></div>
												<p:panelGrid style="width:100%;">
													<p:row>
														<p:column style="width:25%; text-align:right;">
															<h:outputText style="font-weight:bold;"
																value="#{msg['lbl.fclocalpurchasetotalsalecurrencyvalue']}"></h:outputText>
														</p:column>
														<p:column style="width:25%;">
															<p:inputText id="totalSale"
																value="#{foreignCurrencyPurchaseBean.saleAmount}" tabindex="-1"
																readonly="true" />
														</p:column>
														<p:column style="width:25%; text-align:right;">
															<h:outputText style="font-weight:bold;"
																value="#{msg['lbl.fclocalpurchasetotallocalcashentered']}"></h:outputText>
														</p:column>
														<p:column style="width:25%;">
															<p:inputText id="total"
																value="#{foreignCurrencyPurchaseBean.totalValue}" tabindex="-1"
																style="font-weight:bold;" readonly="true" />
														</p:column>
													</p:row>
												</p:panelGrid>

											</p:panel>

											<div class="clearfix"></div>

											<h:panelGroup layout="block" styleClass="shadow_button"
												rendered="#{foreignCurrencyPurchaseBean.booSecondPanelButtons}">

												<p:commandButton id="buttonsavenext"
													value="#{foreignCurrencyPurchaseBean.saveOrNext}"
													style="margin-right:10px;" onstart="javascript:onDone();"
													onclick="process.show();" oncomplete="process.hide()"
													action="#{foreignCurrencyPurchaseBean.saveFromSalePanel}"
													update="mainPanel" />
												<p:commandButton value="#{msg['lbl.back']}"
													onstart="process.show();" onsuccess="process.hide();"
													action="#{foreignCurrencyPurchaseBean.backFromSalePanel}"
													immediate="true" process="@this"
													update="mainPanel, dlgRefundCashMessage" />

												<div class="clearfix"></div>
											</h:panelGroup>

											<div class="clearfix"></div>
										</p:panel>
										<div class="clearfix"></div>

										<p:panel id="refundPanel"
											rendered="#{foreignCurrencyPurchaseBean.booRefundPanel}"
											style="background-color:none !important; padding:0px !important;">

											<table cellpadding="0" cellspacing="0" border="0"
												width="100%" class="mytable">
												<tr>
													<th>#{msg['lbl.fclocalpurchaseserialno']}</th>
													<th>#{msg['lbl.fclocalpurchasedenominationname']}</th>
													<th>#{msg['lbl.fclocalpurchasenoofnotes']}</th>
													<th>#{msg['lbl.fclocalpurchasecashamount']}</th>

												</tr>
												<ui:repeat
													value="#{foreignCurrencyPurchaseBean.lstRefundData}"
													var="f">

													<tr>
														<td style="width: 15% ! important;"><h:outputText
																value="#{f.serial}." /></td>
														<td style="width: 15% ! important;"><h:outputText
																value="#{f.denominationDesc}" /></td>

														<td style="width: 15% ! important;"><p:message
																for="q" display="text"
																style="text-shadow:none !important;" /> <p:inputText
																id="q" value="#{f.qty}"
																style="text-align:center !important;">

																<p:ajax event="change"
																	listener="#{foreignCurrencyPurchaseBean.oncellEditForRefund(f)}"
																	update=":form1:refundTotal,price" process="@this"
																	onstart="process.show();" onsuccess="process.hide();" />

																<p:message for="q" display="text"
																	style="text-shadow:none !important;" />
															</p:inputText></td>
														<td style="width: 15% ! important;"><h:outputText
																value="#{f.price}" id="price" /></td>
													</tr>
												</ui:repeat>

											</table>

											<p:spacer height="10px" />
											<p:panelGrid style="width:100%;">
												<p:row>
													<p:column style="width:25%; text-align:right;">
														<h:outputText style="font-weight:bold;"
															value="#{msg['lbl.totalrefundcashrecepit']}"></h:outputText>
													</p:column>
													<p:column style="width:25%;">
														<p:inputText tabindex="-1"
															value="#{foreignCurrencyPurchaseBean.totalRefundCashRecipt}"
															readonly="true" />
													</p:column>
													<p:column style="width:25%; text-align:right;">
														<h:outputText style="font-weight:bold;"
															value="#{msg['lbl.totallocalcashentered']}"></h:outputText>
													</p:column>
													<p:column style="width:25%;">
														<p:inputText id="refundTotal" tabindex="-1"
															value="#{foreignCurrencyPurchaseBean.totalRefundLocalCashEntered}"
															readonly="true" />
													</p:column>
												</p:row>
											</p:panelGrid>
											<div class="clearfix"></div>

											<h:panelGroup layout="block" styleClass="shadow_button">
												<p:commandButton value="#{msg['lbl.save']}"
													action="#{foreignCurrencyPurchaseBean.saveFromRefundPanel}"
													style="margin-right:10px;" onclick="process.show();"
													oncomplete="process.hide()" update="mainPanel" />

												<p:commandButton value="#{msg['lbl.back']}"
													style="margin-right:10px;"
													action="#{foreignCurrencyPurchaseBean.backFromRefund}"
													update="mainPanel , dlgTotalRefundMessage" />

												<div class="clearfix"></div>
											</h:panelGroup>
											<div class="clearfix"></div>
										</p:panel>
										<p:panel
											rendered="#{foreignCurrencyPurchaseBean.successPanel}"
											style="padding:60px 100px 60px 100px !important;">
											<fieldset
												style="border: 1.5px solid #64b381 !important; padding: 20px 10px !important; -webkit-border-radius: 0 4px 4px 4px !important; border-radius: 0 4px 4px 4px !important;">
												<legend
													style="font-size: 20px; font-weight: bold; color: #037712;"
													align="top">&nbsp;#{msg['lbl.success']}&nbsp;</legend>

												<p:outputLabel
													value="#{msg['lbl.dataSuccessFullySavedClickOkToContinue']}"
													style="font-size: 18px !important; font-weight: bold; color: #037712; padding:20px 150px 20px 230px !important;" />
												<p:panel style="padding-left: 400px;">
													<p:commandButton value="#{msg['lbl.ok']}"
														actionListener="#{foreignCurrencyPurchaseBean.completed}"
														process="@this" immediate="true"
														style="padding: 5px 10px 5px 10px !important;" />
												</p:panel>
												<p:outputLabel value="#{msg['lbl.doYouWantPrintFcPur']}    "
													style=" font-weight: bold; color: #037712; padding:30px 0px 0px 0px !important;">
													<h:commandLink value="#{msg['lbl.clickHere']} "
														actionListener="#{foreignCurrencyPurchaseBean.genarateForeignCurrencyReports}"
														style="font-weight: bold; font-size: 12px !important; color:blue !important; text-decoration:underline !important;"
														process="@this" immediate="true" />
												</p:outputLabel>
											</fieldset>
										</p:panel>
										<h:panelGroup layout="block" class="clearfix" />
									</p:panel>


								</p:panel>

							</h:panelGroup>
							<h:panelGroup layout="block" class="clearfix"></h:panelGroup>
						</h:panelGroup></td>
				</tr>
			</table>
		</h:form>
		<div class="clearfix"></div>
		<ui:include src="#{facesBean.footer}"></ui:include>
	</f:view>
</h:body>
</html>